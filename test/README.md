# YaReader 测试说明

## 测试文件

项目中包含以下测试文件：

- `test_books/剑来.txt`: 10MB 的 TXT 文件，用于测试 TXT 阅读器处理大文件的性能
- `test_books/怪谈研究室 (【日】三津田信三) (Z-Library).epub`: 2.1MB 的 EPUB 文件，用于测试 EPUB 阅读器

## 测试方法

### 1. 命令行测试

使用 Node.js 测试脚本检查测试文件是否可访问：

```bash
node test/test_reader.js
```

该脚本会检查测试文件是否存在，并尝试读取文件内容。

### 2. 浏览器测试

1. 启动开发服务器：

```bash
./start-dev.sh
```

2. 在浏览器中访问测试页面：

```
http://localhost:3000/test
```

3. 点击"测试加载TXT文件"或"测试加载EPUB文件"按钮，测试相应文件的加载和解析。

## 性能优化

为了处理大文件，我们对 TXT 阅读器进行了以下优化：

1. **异步分页处理**：使用 `requestAnimationFrame` 分批处理文本内容，避免阻塞 UI
2. **进度显示**：添加进度条，显示文本处理进度
3. **内存优化**：使用 IndexedDB 存储书籍内容，而不是全部放在内存中

## 已知问题

1. 大文件首次加载可能需要较长时间
2. EPUB 阅读器功能尚未完全实现，目前仅显示简单文本预览

## 后续改进

1. 优化 EPUB 阅读器，支持完整的 EPUB 格式解析
2. 添加文本搜索功能
3. 实现书签和笔记功能
4. 优化大文件加载性能，考虑使用 Web Workers 